(this["webpackJsonpreact-svg-marker"]=this["webpackJsonpreact-svg-marker"]||[]).push([[0],{11:function(e,t,n){},12:function(e,t,n){},13:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(5),o=n.n(c),l=(n(11),n(1)),i=n.p+"static/media/testImg.9c3dc699.png",u=n(6);function d(e,t){switch(t.type){case"draw":var n=!0;return e.map((function(e){return e.selected&&n&&(n=!1,e.point.push(t.payload)),e}));case"add":return[].concat(Object(u.a)(e.map((function(e){return e.selected=!1,e}))),[t.payload]);case"move":var r=!0;return e.map((function(e){return e.selected&&r&&(r=!1,e.point[t.index]=t.payload),e}));case"end":var a=!0;return e.map((function(e){return e.selected&&a&&(e.end=t.end,a=!1),e}));default:throw new Error}}var s=function(e,t,n){var r,a=e.createSVGPoint();a.x=t,a.y=n;var c=a.matrixTransform(null===(r=e.getScreenCTM())||void 0===r?void 0:r.inverse());return{x:c.x,y:c.y}},f=function(e,t){return!(!t||e)},p=function(e,t,n,r){return t.reduce((function(e,t){return"".concat(e," ").concat(t.x," ").concat(t.y)}),"")+(f(n,r)?" ".concat(null===e||void 0===e?void 0:e.x," ").concat(null===e||void 0===e?void 0:e.y):"")},m=function(e,t,n,r){var a="M "+t.reduce((function(e,t){return"".concat(e," ").concat(t.x," ").concat(t.y," L")}),"");return(a+=f(n,r)?" ".concat(e?e.x:""," ").concat(e?e.y:""," L"):"").substr(0,a.length-1)},y=(n(12),a.a.forwardRef((function(e,t){var n,c=e.data,o=e.onChange,i=e.width,u=e.height,f=e.imgUrl,y=Object(r.useRef)(null),v=Object(r.useReducer)(d,c),h=Object(l.a)(v,2),k=h[0],b=h[1],g=Object(r.useState)("view"),w=Object(l.a)(g,2),E=w[0],O=w[1],j=Object(r.useState)({x:0,y:0}),x=Object(l.a)(j,2),C=x[0],S=x[1],M=Object(r.useState)(null),L=Object(l.a)(M,2),W=L[0],R=L[1],D=Object(r.useState)(i||800),F=Object(l.a)(D,1)[0],I=Object(r.useState)(u||600),T=Object(l.a)(I,1)[0];Object(r.useEffect)((function(){var e=U();O(e?e.type:"view"),o(k)}),[k]);var U=function(){return k.filter((function(e){return!0===e.selected}))[0]},N=function(e,t){O(e),b({type:"add",payload:{type:e,color:t,point:[],selected:!0,end:!1}})};return Object(r.useImperativeHandle)(t,(function(){return{drawShap:N}})),a.a.createElement("div",{className:"App"},a.a.createElement("div",{style:{width:F,height:T},className:"container"},a.a.createElement("div",{className:"markData"},a.a.createElement("svg",{onMouseUp:function(){R(null)},style:{userSelect:"none"},ref:y,onMouseMove:function(e){if(y.current){var t=s(y.current,e.clientX,e.clientY);null!==W&&b({type:"move",payload:t,index:W}),S(t)}},onClick:function(e){var t=U();if(t&&!t.end&&2!==e.detail&&y.current){var n=s(y.current,e.clientX,e.clientY);switch(t.type){case"arrow":b({type:"draw",payload:n}),t.point.length>1&&(O("view"),b({type:"end",end:!0}));break;default:b({type:"draw",payload:n})}}},onDoubleClick:function(){"view"!==E&&(O("view"),b({type:"end",end:!0}))},width:F,height:T},a.a.createElement("defs",null,a.a.createElement("marker",{id:"triangle",markerUnits:"strokeWidth",markerWidth:"5",markerHeight:"4",refX:"0",refY:"2",orient:"auto"},a.a.createElement("path",{d:"M 0 0 L 5 2 L 0 4 z",fill:"#f00"}))),k.map((function(e,t){var n=null;switch(e.type){case"arrow":n=e.point&&a.a.createElement("path",{key:t,d:m(C,e.point,e.end,e.selected),stroke:e.color,strokeWidth:"2",fill:"none",style:{markerEnd:e.point.length>1?"url(#triangle)":"none"}});break;case"polyline":n=a.a.createElement("polyline",{key:t,points:p(C,e.point,e.end,e.selected),stroke:e.color,fill:"none",strokeWidth:"5"});break;case"polygon":n=a.a.createElement("polygon",{key:t,points:p(C,e.point,e.end,e.selected),stroke:e.color,fill:"none",strokeWidth:"5"})}return n})),null===(n=k.filter((function(e){return!0===e.selected}))[0])||void 0===n?void 0:n.point.map((function(e,t){return a.a.createElement("circle",{onMouseDown:function(e){!function(e,t,n){U().end&&R(n)}(0,0,t)},key:t,cx:e.x,cy:e.y,r:"8",style:{fill:"transparent",cursor:"pointer"},stroke:"red",strokeWidth:"2",fillOpacity:"1",fillRule:"nonzero"})})))),a.a.createElement("img",{src:f,alt:""})))}))),v=function(){var e=Object(r.useState)([]),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(r.useRef)(null),u=function(e,t){null!==o.current&&o.current.drawShap(e,t)},d=function(e){c((function(t){return t.map((function(t,n){return t.selected=e===n,t}))}))};return a.a.createElement("div",{style:{display:"flex"}},a.a.createElement("div",{style:{width:"300px"}},n.map((function(e,t){return a.a.createElement("div",{onClick:function(){d(t)},key:t},"".concat(e.type," selected:").concat(e.selected),a.a.createElement("button",{onClick:function(){d(t)}},"select"))}))),a.a.createElement(y,{ref:o,imgUrl:i,data:n,onChange:function(e){c(e)}}),a.a.createElement("div",null,a.a.createElement("button",{onClick:function(){return u("arrow","red")}},"arrow"),a.a.createElement("button",{onClick:function(){return u("polygon","yellow")}},"polygon"),a.a.createElement("button",{onClick:function(){return u("polyline","blue")}},"polyline")))},h=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,14)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(v,null)),document.getElementById("root")),h()}},[[13,1,2]]]);
//# sourceMappingURL=main.e72d92a2.chunk.js.map